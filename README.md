RFA 報名資料自動化統計系統 (RFA Registration Automation System)

🚀 專案簡介
  本專案專為解決 RFA 報名流程中，多來源 CSV 資料整合困難、單位名稱不統一及人工核對耗時等問題所開發。透過 Python 與 Streamlit 建立 Web UI，實現一鍵上傳、自動標準化、增量更新及自動化報表產出。

🛠️ 核心技術亮點
1. 啟發式數據標準化 (Heuristic Data Normalization)
  針對使用者輸入不規範的問題（例如：代碼、純中文名稱、縮寫混用），開發了標準化引擎：
    正則匹配 (Regex)：利用 ^[A-Z0-9]{5} 模式精準提取 5 碼單位代碼。
    雙向查找字典 (Bi-directional Mapping)：建立「代碼 ↔ 名稱」映射，自動將「TP838」或「富宅」統一補全為「TP838富宅」。
    暴力去噪：自動清除全形/半形空白、特殊符號及無意義後綴（如「一分處」、「通訊」）。

2. 基於骨架的自動對齊邏輯 (Skeleton-based Data Alignment)
  為確保產出的 Excel 報表順序與原始通訊錄完全一致，本系統捨棄了簡單的 GroupBy 統計，改採：
    左合併 (Left Merge)：以原始 Excel 對照表為基底（Left Table），將報名人數併入。
    補零機制：自動判定行屬性，若為「通訊處」且無人報名則補 0；若為「區部標題」則保持空白，確保報表美觀且具備管理意義。

3. 複雜表格自動解析 (Complex File Slicing)
  針對原始對照表包含大量非結構化資訊（如電話、地址、重複標頭）：
    動態過濾：自動跳過 Excel 中的重複標頭行及空行。
    標題擷取：透過長度判定邏輯區分單位與標題，並自動對標題進行切片處理（僅取前四碼）以優化 UI 顯示。

📦 功能說明
  增量更新：支援多次上傳不同批次的報名檔，系統會自動根據「單位+姓名」排除重複紀錄並更新資料庫。
  預覽功能：在合併前提供即時數據預覽，降低誤傳風險。
  一鍵匯出：自動產出包含「人數統計表」與「詳細名單」的雙分頁 Excel 報表。

💻 執行環境
  語言：Python 3.9+
  框架：Streamlit, Pandas, Openpyxl
  部署：支援 Streamlit Cloud 雲端部署

📂 目錄結構
  app.py: Streamlit 主程式與 Web UI 邏輯。
  master_data.csv: 系統自動維護的主資料庫檔案。
  FB11407F通訊處20260101.xlsx: 系統運行所需的單位對照基準表。

🎓 專案省思
  在這個專案中，我學會了如何從使用者的角度出發思考產品。技術不只是寫程式，更包含：
    處理真實世界的髒數據：課本上的資料都很乾淨，但現實中的 Excel 有標題、有分頁、有各種錯字。
    優化使用者體驗 (UX)：透過 st.cache_data 優化讀取效能，以及利用 st.download_button 提供直觀的下載流程。

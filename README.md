RFA 報名資料自動化統計系統  https://rze3rje3hbz8ygwjqxp2hn.streamlit.app/

🚀 專案簡介

  本專案專為解決 RFA 報名流程中，多來源 CSV 資料整合困難、單位名稱不統一及人工核對耗時等問題所開發。透過 Python 與 Streamlit 建立 Web UI，實現一鍵上傳、自動標準化、增量更新及自動化報表產出。

🛠️ 核心技術亮點

    1. 啟發式數據標準化 (Heuristic Data Normalization)
      針對使用者輸入不規範的問題（例如：代碼、純中文名稱、縮寫混用），開發了標準化引擎：
        正則匹配 (Regex)：利用 ^[A-Z0-9]{5} 模式精準提取 5 碼單位代碼。
        雙向查找字典 (Bi-directional Mapping)：建立「代碼 ↔ 名稱」映射，自動將「TP838」或「富宅」統一補全為「TP838富宅」。
        資料清理：自動清除全形/半形空白、特殊符號及無意義後綴（如「一分處」、「通訊」）。
    
    2. 基於骨架的自動對齊邏輯 (Skeleton-based Data Alignment)
      為確保產出的 Excel 報表順序與原始通訊錄完全一致，本系統捨棄了簡單的 GroupBy 統計，改採：
        左合併 (Left Merge)：以原始 Excel 對照表為基底（Left Table），將報名人數併入。
        補零機制：自動判定行屬性，若為「通訊處」且無人報名則補 0；若為「區部標題」則保持空白，確保報表美觀且具備管理意義。
    
    3. 複雜表格自動解析 (Complex File Slicing)
      針對原始對照表包含大量非結構化資訊（如電話、地址、重複標頭）：
        動態過濾：自動跳過 Excel 中的重複標頭行及空行。
        標題擷取：透過長度判定邏輯區分單位與標題，並自動對標題進行切片處理（僅取前四碼）以優化 UI 顯示。

📦 功能說明

    增量更新：支援多次上傳不同批次的報名檔，系統會自動根據「單位+姓名」排除重複紀錄並更新資料庫。
    預覽功能：在合併前提供即時數據預覽，降低誤傳風險。
    一鍵匯出：自動產出包含「人數統計表」與「詳細名單」的雙分頁 Excel 報表。

💻 執行環境

    語言：Python 3.9+
    框架：Streamlit, Pandas, Openpyxl
    部署：支援 Streamlit Cloud 雲端部署

📂 目錄結構

    app.py: Streamlit 主程式與 Web UI 邏輯。
    master_data.csv: 系統自動維護的主資料庫檔案。
    ref_df.csv: 系統運行所需的單位對照基準表
    FB11407F通訊處20260101.xlsx: 單位對照基準表原檔(需進行清理)。

🎓 專案實務省思：從需求定義到 AI 協作開發

    1. 深度理解業務痛點：將「非技術語言」轉化為「邏輯規則」
      在實務中，客戶通常無法準確描述技術邏輯，只能給出「報表順序要跟原本的一樣」、「有人寫錯字要能統計到」等模糊需求。
      需求轉換：我學會了如何從不標準的 Excel 操作習慣中，歸納出「左合併 (Left Merge)」的骨架邏輯與「正規表達式 (Regex)」的過濾規則。
      動態調整：理解到行政作業中「區部標題」的對齊比單純的數據加總更具備閱讀價值，因此開發了區分「通訊處」與「標題列」的判斷機制。
    
    2. 真實世界數據的韌性處理 (Data Resilience)
      課本的數據是完美的 CSV，但現實是充滿雜訊的 Excel。
      容錯設計：系統必須處理包含重複標頭、跨列文字、以及各種全半形/空白混用的髒數據。
      標準化邏輯：我設計了多層次的篩選器，包括代碼長度判定及模糊關鍵字提取，確保數據在進入統計前已完成清洗。
    
    3. AI 協作開發 (AI-Augmented Development) 
      雖然我目前在語法手刻上還不夠熟練，但我成功展現了系統架構設計與模組化思維：
      敏捷開發：透過精準的需求拆解（如：分段要求檔案讀取、標準化邏輯、UI 介面設計），在與 Gemini 的合作下，僅用 約兩天 完成了一個具備數據持久化（Incremental Update）功能的 Web App。
      提示工程 (Prompt Engineering)：我學會如何透過分段指令引導 AI 進行邏輯整合，並在遇到 bug 時（如路徑錯誤或邏輯判斷失靈）進行有效的排錯對話。
    
    4. 效能與 UX 的平衡
      效能優化：利用 st.cache_data 避免重複讀取大型 Excel 造成的效能損耗。
      交付價值：利用 st.download_button 實現一鍵產出雙分頁 Excel 報表，真正解決了從上傳到下載的完整工作流。
